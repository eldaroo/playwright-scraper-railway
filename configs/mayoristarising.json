{
  "site_name": "Mayorista Rising",
  "base_url": "https://www.mayoristarising.com.ar",
  "use_predefined_urls": true,
  "urls": [
    "https://www.mayoristarising.com.ar/maquillaje1/sombras2/",
    "https://www.mayoristarising.com.ar/maquillaje1/labiales/",
    "https://www.mayoristarising.com.ar/maquillaje1/delineadores-y-mascaras/",
    "https://www.mayoristarising.com.ar/maquillaje1/bases-y-correctores/",
    "https://www.mayoristarising.com.ar/maquillaje1/corrector-iluminador-y-contorno/",
    "https://www.mayoristarising.com.ar/maquillaje1/primer-fijador-y-desmaquillante/",
    "https://www.mayoristarising.com.ar/maquillaje1/brochas-y-pinceles/",
    "https://www.mayoristarising.com.ar/maquillaje1/perfumes1/",
    "https://www.mayoristarising.com.ar/maquillaje1/cremas/",
    "https://www.mayoristarising.com.ar/mascarillas-y-accesorios/",
    "https://www.mayoristarising.com.ar/unas-y-pestanas/esmaltes/",
    "https://www.mayoristarising.com.ar/unas-y-pestanas/unas-y-accesorios/",
    "https://www.mayoristarising.com.ar/unas-y-pestanas/insumos-para-unas/",
    "https://www.mayoristarising.com.ar/unas-y-pestanas/pestanas-y-accesorios/",
    "https://www.mayoristarising.com.ar/accesorios/invierno/",
    "https://www.mayoristarising.com.ar/accesorios/accesorios-para-el-cabello/",
    "https://www.mayoristarising.com.ar/accesorios/bijouterie/",
    "https://www.mayoristarising.com.ar/accesorios/llaveros/",
    "https://www.mayoristarising.com.ar/accesorios/accesorios-varios/",
    "https://www.mayoristarising.com.ar/regaleria-y-bazar/juguetes/",
    "https://www.mayoristarising.com.ar/regaleria-y-bazar/mascotas/",
    "https://www.mayoristarising.com.ar/regaleria-y-bazar/herramientas/",
    "https://www.mayoristarising.com.ar/regaleria-y-bazar/bazar/",
    "https://www.mayoristarising.com.ar/regaleria-y-bazar/regaleria/",
    "https://www.mayoristarising.com.ar/ofertas/"
  ],
  "crawler_params": {
    "headless": true,
    "defaultViewport": {
      "width": 1280,
      "height": 800
    },
    "args": [
      "--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36",
      "--disable-extensions",
      "--disable-dev-shm-usage",
      "--no-sandbox",
      "--disable-gpu"
    ]
  },
  "pre_actions": [
    { "type": "waitForLoadState", "state": "domcontentloaded" },
    { "type": "waitForLoadState", "state": "networkidle" },
    { "type": "waitForSelector", "selector": "div.js-item-product", "timeout": 20000 },
    {
      "type": "evaluate",
      "script": "(async () => { const sleep = ms => new Promise(resolve => setTimeout(resolve, ms)); const selectors = { product: '.js-item-product', loadMore: '.js-load-more' }; const getButton = () => document.querySelector(selectors.loadMore); const start = Date.now(); const maxRuntime = 240000; const maxIdleRounds = 60; let idleRounds = 0; let lastCount = document.querySelectorAll(selectors.product).length; const log = (...args) => console.log('[MR-Loader]', ...args); const isVisible = el => { if (!el) return false; const style = window.getComputedStyle(el); return el.offsetParent !== null && style.display !== 'none' && style.visibility !== 'hidden'; }; log('start', lastCount, 'products'); while (Date.now() - start < maxRuntime && idleRounds < maxIdleRounds) { window.scrollBy(0, window.innerHeight * 0.8); window.scrollTo(0, document.body.scrollHeight); await sleep(900); const btn = getButton(); if (isVisible(btn) && !btn.hasAttribute('disabled')) { btn.scrollIntoView({ behavior: 'smooth', block: 'center' }); btn.click(); let waited = 0; while (waited < 20000) { await sleep(500); waited += 500; const current = document.querySelectorAll(selectors.product).length; if (current > lastCount) { lastCount = current; idleRounds = 0; log('loaded via button', current); break; } const loaderBtn = getButton(); if (!loaderBtn || !loaderBtn.classList.contains('btn-loading')) { break; } } } const currentCount = document.querySelectorAll(selectors.product).length; if (currentCount > lastCount) { lastCount = currentCount; idleRounds = 0; log('loaded via scroll', currentCount); } else { idleRounds++; } await sleep(700); } window.scrollTo(0, document.body.scrollHeight); await sleep(2000); log('finished with', document.querySelectorAll(selectors.product).length, 'products after', Math.round((Date.now() - start) / 1000), 's'); })()"
    },
    { "type": "waitForTimeout", "timeout": 4000 },
    {
      "type": "evaluate",
      "script": "document.querySelectorAll('.js-item-product img').forEach(img => { if (img.dataset.srcset && (!img.getAttribute('srcset') || img.getAttribute('srcset').includes('data:image'))) { img.setAttribute('srcset', img.dataset.srcset); } if (img.dataset.src && (!img.getAttribute('src') || img.getAttribute('src').includes('data:image'))) { img.setAttribute('src', img.dataset.src); } });"
    },
    { "type": "waitForTimeout", "timeout": 2000 }
  ],
  "post_actions": [],
  "extraction_config": {
    "type": "json_css",
    "params": {
      "schema": {
        "name": "Mayorista Rising",
        "baseSelector": "div.js-item-product",
        "fields": [
          {
            "name": "title",
            "selector": "div.js-item-name",
            "type": "text",
            "transform": "return data ? data.trim() : null;"
          },
          {
            "name": "price",
            "selector": "span.js-price-display",
            "type": "text",
            "transform": "return data ? data.replace(/[^\\d.,]/g, '').replace(/(\\.00|,00)$/, '').trim() : null;"
          },
          {
            "name": "image",
            "selector": "div.js-product-container",
            "type": "attribute",
            "attribute": "data-variants",
            "transform": "const toAbsolute = value => { if (!value) return null; const clean = value.trim(); if (!clean) return null; return clean.startsWith('//') ? 'https:' + clean : clean; }; let selected = null; if (data) { try { const variants = JSON.parse(data); if (Array.isArray(variants) && variants.length > 0) { selected = toAbsolute(variants[0].image_url || variants[0].image); } } catch (err) { selected = null; } } if (!selected && element) { const img = element.closest('.item').querySelector('div.product-item-image-container img'); if (img) { const srcset = img.getAttribute('srcset') || img.dataset.srcset; if (srcset) { const entries = srcset.split(',').map(part => part.trim()).filter(Boolean); if (entries.length > 0) { const best = entries.reduce((acc, curr) => { const accWidth = parseInt(acc.match(/(\\\\d+)w$/)?.[1] || '0', 10); const currWidth = parseInt(curr.match(/(\\\\d+)w$/)?.[1] || '0', 10); return currWidth > accWidth ? curr : acc; }, entries[0]); selected = toAbsolute(best.split(' ')[0]); } } if (!selected) { selected = toAbsolute(img.getAttribute('src') || img.dataset.src); } } } return selected;"
          },
          {
            "name": "url",
            "selector": "div.item-description a.item-link",
            "type": "attribute",
            "attribute": "href"
          },
          {
            "name": "status",
            "selector": "div.js-stock-label",
            "type": "text",
            "transform": "const style = element ? (element.getAttribute('style') || '') : ''; return style.includes('display:none') ? 'in_stock' : 'out_of_stock';"
          },
          {
            "name": "category",
            "type": "url_extract",
            "pattern": "https://www\\.mayoristarising\\.com\\.ar/([^?#]+)",
            "transform": "if (!data) return null; const parts = data.split('/').filter(Boolean); let segment = parts.pop() || ''; segment = decodeURIComponent(segment).replace(/[-_]/g, ' ').replace(/\\d+$/, '').trim(); if (!segment && parts.length) { segment = decodeURIComponent(parts.pop()).replace(/[-_]/g, ' ').trim(); } return segment ? segment.replace(/\\s+/g, ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') : null;"
          },
          {
            "name": "source_url",
            "type": "url"
          },
          {
            "name": "scraped_at",
            "type": "timestamp"
          },
          {
            "name": "site_name",
            "type": "constant",
            "value": "Mayorista Rising"
          }
        ]
      },
      "verbose": true
    }
  },
  "cache_mode": "bypass",
  "semaphore_count": 2,
  "request_delay": 1000,
  "verbose": true
}
